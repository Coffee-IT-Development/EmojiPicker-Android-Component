image: docker:20.10
services:
  - docker:20.10-dind

stages:
  - build

build-main:
  image: cfmanteiga/alpine-bash-curl-jq
  stage: build
  only:
    - main
  script:
    - chmod +x ./gitrise.sh
    - ./gitrise.sh -a $BITRISE_ACCESS_TOKEN -s $BITRISE_PROJ_SLUG -w release -b $CI_COMMIT_REF_NAME --stream

build-develop:
   image: cfmanteiga/alpine-bash-curl-jq
   stage: build
   only:
     - develop
   script:
     - echo "access token:" "$BITRISE_ACCESS_TOKEN"
     - echo "project slug:" "$BITRISE_PROJ_SLUG"
     - chmod +x ./gitrise.sh
     - ./gitrise.sh -a $BITRISE_ACCESS_TOKEN -s $BITRISE_PROJ_SLUG -w release -b $CI_COMMIT_REF_NAME --stream